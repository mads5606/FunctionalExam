{"version":3,"file":"index.js","sourceRoot":"","sources":["../src/index.ts"],"names":[],"mappings":";;AAYA,gBAAiB,MAAW,EAAE,IAAkB;IAC9C,EAAE,CAAC,CAAC,MAAM,IAAI,OAAO,MAAM,CAAC,IAAI,KAAK,UAAU,CAAC,CAAC,CAAC;QAChD,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,EAAE,UAAU,GAAU;YAChD,MAAM,CAAC,IAAI,CAAC,GAAG,IAAI,IAAI,KAAK,CAAC,yCAAyC,CAAC,CAAC,CAAA;QAC1E,CAAC,CAAC,CAAA;IACJ,CAAC;IAED,MAAM,CAAC,MAAM,CAAA;AACf,CAAC;AAID,cAA6B,EAAsC;IACjE,EAAE,CAAC,CAAC,EAAE,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC,CAAC;QACpB,MAAM,CAAC,UAAU,GAAU,EAAE,GAAM,EAAE,GAAM,EAAE,IAAkB;YAC7D,MAAM,CAAC,MAAM,CAAE,EAAyB,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,CAAC,EAAE,IAAI,CAAC,CAAA;QACtE,CAAC,CAAA;IACH,CAAC;IAED,MAAM,CAAC,UAAU,GAAM,EAAE,GAAM,EAAE,IAAkB;QACjD,MAAM,CAAC,MAAM,CAAE,EAAoB,CAAC,GAAG,EAAE,GAAG,EAAE,IAAI,CAAC,EAAE,IAAI,CAAC,CAAA;IAC5D,CAAC,CAAA;AACH,CAAC;AAVD,oBAUC","sourcesContent":["export interface NextFunction {\n  (err?: Error): void\n}\n\nexport interface Handler <T, U> {\n  (req: T, res: U, next: NextFunction): any\n}\n\nexport interface ErrorHandler <T, U> {\n  (err: Error, req: T, res: U, next: NextFunction): any\n}\n\nfunction handle (result: any, next: NextFunction) {\n  if (result && typeof result.then === 'function') {\n    return result.then(undefined, function (err: Error) {\n      return next(err || new Error('Promise was rejected with a falsy value'))\n    })\n  }\n\n  return result\n}\n\nexport function wrap <T, U> (fn: Handler<T, U>): Handler<T, U>\nexport function wrap <T, U> (fn: ErrorHandler<T, U>): ErrorHandler<T, U>\nexport function wrap <T, U> (fn: Handler<T, U> | ErrorHandler<T, U>): Handler<T, U> | ErrorHandler<T, U> {\n  if (fn.length === 4) {\n    return function (err: Error, req: T, res: U, next: NextFunction): any {\n      return handle((fn as ErrorHandler<T, U>)(err, req, res, next), next)\n    }\n  }\n\n  return function (req: T, res: U, next: NextFunction): any {\n    return handle((fn as Handler<T, U>)(req, res, next), next)\n  }\n}\n"]}